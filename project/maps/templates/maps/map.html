{% extends 'base.html' %}

{% load static %}
{% load datetime_filter %}
{% load humanize %}


{% block head %}
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <script type="text/javascript" src="//maps.google.com/maps/api/js?key={{ google_api_key }}"></script>
    <!-- <script type="text/javascript" src="//maps.google.com/maps/api/js?sensor=true"></script> -->
    <script type="text/javascript" src="{% static 'js/gmaps.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/prettify.js' %}"></script>
    <link rel='stylesheet' id='google-font-playfair-display-css' href='//fonts.googleapis.com/css?family=Playfair+Display:400,%20%20%20%20400italic,700,700italic,900,900italic' type='text/css' media='all' />
    <link rel='stylesheet' id='google-font-lora-css'  href='//fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic' type='text/css' media='all' />
    <link href="{% static 'css/style.css' %}" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="{{ MEDIA_URL }}points/{{ trip.pk }}-points.js?v={{ js_version }}"></script>

{% endblock %}

{% block content %}
    <!-- Loader -->
    <div class="htmx-indicator loader loader-default is-active" id="indicator"></div>

    <div class="row mx-auto pt-3">
        <div class="col-sm-12 mx-auto" style="text-align:center;">
            <h2>{{ trip.title }}</h2>
            <p>{{ trip.description }}</p>
        </div>
    </div>

    <div class="map_row">
        <div class="popin">
            <div id="map"></div>
        </div>
    </div>

    <div class="row mx-auto">
        <div class="col- mx-auto pt-3 text-center">
            <p class="stats">
                {% now "Y-m-d" as todays_date %}
                {% if todays_date < trip.start_date|date:"Y-m-d" %}
                Kelionė dar neprasidėjo.
                {% elif todays_date > trip.end_date|date:"Y-m-d" %}
                Kelionė jau pasibaigusi.
                {% else %}
                <b>{{ statistic.total_days }}</b> diena kelyje.{% endif %}
                Nuvažiavau <b>{{ statistic.total_km|floatformat:2 }}</b>km per <b>{{ statistic.total_time|format_datetime }}</b>. Pakilau <b>{{ statistic.total_ascent|floatformat:0|intcomma }}</b>m. Nusileidau <b>{{ statistic.total_descent|floatformat:0|intcomma }}</b>m</p>
        </div>
    </div>

    <div hx-trigger="load" hx-get="{% url 'maps:posts' trip.slug %}" hx-swap="outerHTML"></div>

{% endblock %}
